<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Baroud Services - Neon Pro</title>

  <!-- âœ… Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body{
      margin:0;
      font-family: system-ui,Arial;
      background:#020b14;
      color:#fff;
    }

    .overlay{
      position:fixed; inset:0;
      background:rgba(0,0,0,.65);
      opacity:0; pointer-events:none;
      transition:.2s;
      z-index:9998;
    }
    .overlay.show{ opacity:1; pointer-events:auto; }

    aside{
      position:fixed; top:0; left:0;
      width:280px; height:100%;
      background:rgba(10,14,22,.98);
      border-right:1px solid rgba(255,255,255,.08);
      transform:translateX(-100%);
      transition:.22s ease;
      z-index:9999;
      padding:16px;
      box-sizing:border-box;
    }
    aside.show{ transform:translateX(0); }

    .m-head{
      display:flex; align-items:center; justify-content:space-between;
      padding:8px 6px 14px;
      border-bottom:1px solid rgba(255,255,255,.08);
      margin-bottom:12px;
    }
    .m-title{ font-weight:900; letter-spacing:.5px; }
    .m-close{
      width:40px; height:40px; border-radius:12px;
      border:1px solid rgba(255,255,255,.1);
      background:rgba(255,255,255,.06);
      color:#fff; cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      font-size:18px;
    }

    .m-item{
      display:flex; align-items:center; gap:10px;
      padding:12px 10px;
      border-radius:14px;
      color:#fff;
      text-decoration:none;
      border:1px solid rgba(255,255,255,.06);
      background:rgba(255,255,255,.03);
      margin-bottom:10px;
    }
    .m-item:hover{ background:rgba(255,255,255,.06); }
    .m-dot{ width:10px; height:10px; border-radius:999px; background:#38bdf8; }
    .logout-dot{ background:#ef4444; }

    .page{
      max-width:980px;
      margin:0 auto;
      padding:16px;
      padding-bottom:90px;
      box-sizing:border-box;
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:16px;
    }
    .topbar-left{
      display:flex; align-items:center; gap:10px;
    }
    .menu-trigger{
      width:44px; height:44px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.1);
      background:rgba(255,255,255,.06);
      display:flex; align-items:center; justify-content:center;
      cursor:pointer;
      user-select:none;
      font-size:20px;
    }
    .brand-title{
      font-weight:950;
      letter-spacing:1px;
      opacity:.9;
    }

    .wallet-pill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .star-icon{
      width:26px; height:26px;
      border-radius:10px;
      display:flex; align-items:center; justify-content:center;
      background:rgba(56,189,248,.18);
      border:1px solid rgba(56,189,248,.35);
      color:#38bdf8;
      font-weight:900;
      font-size:14px;
    }
    .balance-text{
      font-weight:950;
      letter-spacing:.3px;
      white-space:nowrap;
    }
    .add-fund-btn{
      width:28px; height:28px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      color:#fff;
      font-weight:900;
      cursor:pointer;
      line-height:1;
    }

    .slider-box{
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
      margin-bottom:12px;
    }
    .slides{
      display:flex;
      transition: transform .5s ease;
    }
    .slides img{
      width:100%;
      height:180px;
      object-fit:cover;
      flex:0 0 100%;
      display:block;
    }

    .support-slider{
      overflow:hidden;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.04);
      margin-bottom:16px;
    }
    .support-track{
      display:flex;
      gap:26px;
      padding:10px 14px;
      animation: marquee 14s linear infinite;
      white-space:nowrap;
      align-items:center;
    }
    .support-item{
      display:flex; align-items:center; gap:10px;
      font-weight:800;
      opacity:.9;
    }
    @keyframes marquee{
      0%{ transform:translateX(0); }
      100%{ transform:translateX(-33.333%); }
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(2, minmax(0,1fr));
      gap:12px;
    }
    @media (min-width: 720px){
      .grid{ grid-template-columns:repeat(4, minmax(0,1fr)); }
      .slides img{ height:240px; }
    }
    .tile{
      position:relative;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03);
      cursor:pointer;
      text-decoration:none;
      color:#fff;
      min-height:120px;
      display:flex;
      align-items:flex-end;
    }
    .tile img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      opacity:.88;
      transform:scale(1.05);
    }
    .tile::after{
      content:"";
      position:absolute; inset:0;
      background:linear-gradient(180deg, rgba(0,0,0,0) 40%, rgba(0,0,0,.75));
    }
    .tile .label{
      position:relative;
      z-index:2;
      padding:12px;
      font-weight:950;
      letter-spacing:.3px;
    }

    .bottom-nav{
      position:fixed;
      left:0; right:0; bottom:0;
      display:flex;
      justify-content:space-around;
      align-items:center;
      gap:10px;
      padding:10px 10px 14px;
      background:rgba(6,10,18,.94);
      border-top:1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(10px);
      z-index:9997;
    }
    .nav-btn{
      width:62px;
      height:44px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.04);
      display:flex;
      align-items:center;
      justify-content:center;
      color:#fff;
      cursor:pointer;
      text-decoration:none;
      font-weight:900;
    }
    .nav-btn.active{
      background:rgba(56,189,248,.16);
      border-color:rgba(56,189,248,.35);
    }
  </style>
</head>

<body>
  <div class="overlay" id="overlay"></div>

  <aside id="drawer">
    <div class="m-head">
      <div class="m-title">Menu</div>
      <button class="m-close" id="closeBtn">âœ•</button>
    </div>

    <a href="services.html" class="m-item"><div class="m-dot"></div><span>Home</span></a>
    <a href="account.html" class="m-item"><div class="m-dot"></div><span>Account</span></a>
    <a href="my-orders.html" class="m-item"><div class="m-dot"></div><span>My Orders</span></a>
    <a href="add-credit.html" class="m-item"><div class="m-dot"></div><span>Add Credit</span></a>
    <a href="login.html" class="m-item"><div class="m-dot logout-dot"></div><span>Logout</span></a>
  </aside>

  <div class="page">
    <div class="topbar">
      <div class="topbar-left">
        <div class="menu-trigger" id="menuBtn">â˜°</div>

        <!-- âœ… Wallet (Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…) -->
        <div class="wallet-pill">
          <span class="star-icon">â˜…</span>
          <span class="balance-text">0 ðŸ‡±ðŸ‡§</span>
          <button class="add-fund-btn" onclick="location.href='add-credit.html'">+</button>
        </div>
      </div>

      <div class="brand-title">BAROUD</div>
    </div>

    <div class="slider-box">
      <div class="slides" id="mainSlider">
        <img src="assets/banner1.jpg" alt="1">
        <img src="assets/banner2.jpg" alt="2">
        <img src="assets/banner3.jpg" alt="3">
      </div>
    </div>

    <div class="support-slider">
      <div class="support-track">
        <div class="support-item"><span>ðŸ“ž</span> Support Number</div>
        <div class="support-item"><span>âœ…</span> Fast Delivery</div>
        <div class="support-item"><span>ðŸ”’</span> Secure Payments</div>

        <div class="support-item"><span>ðŸ“ž</span> Support Number</div>
        <div class="support-item"><span>âœ…</span> Fast Delivery</div>
        <div class="support-item"><span>ðŸ”’</span> Secure Payments</div>

        <div class="support-item"><span>ðŸ“ž</span> Support Number</div>
        <div class="support-item"><span>âœ…</span> Fast Delivery</div>
        <div class="support-item"><span>ðŸ”’</span> Secure Payments</div>
      </div>
    </div>

    <div class="grid">
      <a class="tile" href="accounts.html">
        <img src="assets/accounts.png" alt="Accounts">
        <div class="label">Accounts</div>
      </a>

      <a class="tile" href="games.html">
        <img src="assets/games.png" alt="Games">
        <div class="label">Games</div>
      </a>

      <a class="tile" href="giftcards.html">
        <img src="assets/giftcards.png" alt="Gift Cards">
        <div class="label">Gift Cards</div>
      </a>

      <a class="tile" href="apps.html">
        <img src="assets/apps.png" alt="Apps">
        <div class="label">Apps</div>
      </a>
    </div>
  </div>

  <nav class="bottom-nav">
    <a class="nav-btn active" href="services.html">Home</a>
    <a class="nav-btn" href="account.html">Account</a>
    <a class="nav-btn" href="my-orders.html">Orders</a>
    <a class="nav-btn" href="add-credit.html">+</a>
  </nav>

  <script>
    const drawer = document.getElementById("drawer");
    const overlay = document.getElementById("overlay");
    const menuBtn = document.getElementById("menuBtn");
    const closeBtn = document.getElementById("closeBtn");

    const openSidebar = () => {
      drawer.classList.add("show");
      overlay.classList.add("show");
    };
    const closeSidebar = () => {
      drawer.classList.remove("show");
      overlay.classList.remove("show");
    };

    menuBtn.onclick = openSidebar;
    closeBtn.onclick = closeSidebar;
    overlay.onclick = closeSidebar;

    // Slider
    const slider = document.getElementById("mainSlider");
    let idx = 0;
    setInterval(() => {
      idx = (idx + 1) % 3;
      slider.style.transform = `translateX(-${idx * 100}%)`;
    }, 4000);
  </script>

  <!-- âœ… Ø±Ø¨Ø· Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ù† Supabase -->
  <script>
    const SUPABASE_URL = "https://pqrwitolonhfbfwtsnde.supabase.co";
    const SUPABASE_KEY = "sb_publishable_l5PtPu6xVyWq2pD6jzEYRw_CYEQ9-f_";
    const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    function fmtLBP(n){
      const x = Number(n || 0);
      try{
        return new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(x);
      }catch(e){
        return String(Math.round(x));
      }
    }

    async function loadBalance(){
      const el = document.querySelector(".balance-text");
      if(!el) return;

      const { data: { session } } = await sb.auth.getSession();
      if(!session){
        el.textContent = "0 ðŸ‡±ðŸ‡§";
        return;
      }

      const { data, error } = await sb
        .from("profiles")
        .select("balance")
        .eq("id", session.user.id)
        .single();

      if(error){
        console.warn("Balance error:", error.message);
        el.textContent = "0 ðŸ‡±ðŸ‡§";
        return;
      }

      el.textContent = `${fmtLBP(data?.balance)} ðŸ‡±ðŸ‡§`;
    }

    loadBalance();

    // Realtime update Ù„Ùˆ Ø§Ù„Ø±ØµÙŠØ¯ ØªØºÙŠÙ‘Ø±
    sb.channel('balance-watch')
      .on('postgres_changes', { event: 'UPDATE', schema: 'public', table: 'profiles' }, (payload) => {
        sb.auth.getSession().then(({ data: { session } }) => {
          if(session && payload.new && payload.new.id === session.user.id){
            const el = document.querySelector(".balance-text");
            if(el) el.textContent = `${fmtLBP(payload.new.balance)} ðŸ‡±ðŸ‡§`;
          }
        });
      })
      .subscribe();
  </script>
</body>
</html>
