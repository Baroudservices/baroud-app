<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Services | Baroud</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#061a2e,#061325);
      color:#fff;
      padding:16px;
    }
    .box{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.08);
      border-radius:22px;
      padding:16px;
      box-shadow:0 18px 60px rgba(0,0,0,.25);
    }
    .row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-bottom:12px}
    .btn{
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      color:#fff;
      font-weight:900;
      cursor:pointer;
    }
  </style>
</head>

<body>

  <div class="box">
    <div class="row">
      <div style="font-weight:900;font-size:18px">Services</div>
      <button class="btn" onclick="logout()">Logout</button>
    </div>

    <div style="opacity:.85">✅ You are logged in.</div>
    <div style="margin-top:10px;opacity:.7" id="userEmail"></div>
  </div>

<script>
  const BASE = "https://baroudservices.github.io/baroud-app/";
  const SUPABASE_URL = "https://pqrwitolonhfbfwtsnde.supabase.co";
  const SUPABASE_KEY = "sb_publishable_l5PtPu6xVyWq2pD6jzEYRw_CYEQ9-f_";
  const supabase = supabaseJs.createClient(SUPABASE_URL, SUPABASE_KEY);

  (async () => {
    const { data } = await supabase.auth.getSession();
    const user = data.session?.user;

    // ✅ ممنوع تفتح بدون login
    if(!user){
      window.location.replace(BASE + "login.html?v=" + Date.now());
      return;
    }

    document.getElementById("userEmail").textContent = "Email: " + (user.email || "");
  })();

  async function logout(){
    await supabase.auth.signOut();
    window.location.replace(BASE + "index.html?v=" + Date.now());
  }
</script>

</body>
</html>
